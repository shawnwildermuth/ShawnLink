(function(){"use strict";var e={3038:function(e,t,n){var r=n(9242),l=n(3396),i=n(7139);const a={class:"bg-white text-dark"},s={class:"navbar navbar-dark bg-dark"},o={class:"nav nav-pill"},u={class:"nav-item"},c=(0,l.Uk)("List"),d={class:"nav-item"},v=(0,l.Uk)("New"),p={class:"nav-item"},y=(0,l.Uk)("Reports"),f={class:"row"},k={class:"col-12"},h={key:0,class:"alert alert-danger"},b={key:1,class:"alert alert-info"},m=(0,l._)("i",{class:"fas fa-spin fa-spinner"},null,-1),_={class:"row"},w={class:"col-12"};function g(e,t,n,r,g,E){const L=(0,l.up)("router-link"),C=(0,l.up)("router-view");return(0,l.wg)(),(0,l.iD)("div",a,[(0,l._)("nav",s,[(0,l._)("ul",o,[(0,l._)("li",u,[(0,l.Wm)(L,{to:"/",class:"nav-link"},{default:(0,l.w5)((()=>[c])),_:1})]),(0,l._)("li",d,[(0,l.Wm)(L,{to:"/editor",class:"nav-link"},{default:(0,l.w5)((()=>[v])),_:1})]),(0,l._)("li",p,[(0,l.Wm)(L,{to:"/summaries",class:"nav-link"},{default:(0,l.w5)((()=>[y])),_:1})])])]),(0,l._)("div",f,[(0,l._)("div",k,[e.error?((0,l.wg)(),(0,l.iD)("div",h,(0,i.zw)(e.error),1)):(0,l.kq)("",!0),e.isBusy?((0,l.wg)(),(0,l.iD)("div",b,[m,(0,l.Uk)(" "+(0,i.zw)(e.busyMessage),1)])):(0,l.kq)("",!0),(0,l._)("div",_,[(0,l._)("div",w,[(0,l.Wm)(C)])])])])])}var E=n(4870),L=n(6265),C=n.n(L);const B={isBusy:(0,E.iH)(!1),busyMessage:(0,E.iH)(""),error:(0,E.iH)(""),links:(0,E.iH)([]),isLoaded:(0,E.iH)(!1),async loadLinks(){this.setBusy("Loading Links..."),this.clearError();try{var e=await C().get("/api/links");this.links.value=e.data.sort(((e,t)=>e.key.localeCompare(t.key))),this.isLoaded.value=!0}catch(t){console.error(t),this.setError("Failed to load links")}finally{this.clearBusy()}},async loadSummaries(){this.setBusy("Loading Report"),this.clearError();try{var e=await C().get("/api/links/summary");return e.data}catch(t){console.error(t),this.setError("Failed to load report")}finally{this.clearBusy()}},setError(e){this.error.value=e},clearError(){this.error.value=""},setBusy(e){this.isBusy.value=!0,e&&(this.busyMessage.value=e)},clearBusy(){this.isBusy.value=!1,this.busyMessage.value=""}};var H=B,D={setup(){return{...H}}},O=n(89);const S=(0,O.Z)(D,[["render",g]]);var x=S,K=n(678);const U={class:"row"},j={class:"col-12"},z=(0,l._)("h2",null,"Links Management",-1),M={class:"table-responsive"},N={class:"table table-sm table-bordered"},q=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"Key"),(0,l._)("th",null,"Destination"),(0,l._)("th",null,"Link"),(0,l._)("th")])],-1),F=["href","title"],T=["href"],W={class:"btn-group",role:"group"},Z=(0,l.Uk)("Edit"),R=["onClick"],$=["onClick"];function P(e,t,n,r,a,s){const o=(0,l.up)("router-link");return(0,l.wg)(),(0,l.iD)("div",U,[(0,l._)("div",j,[z,(0,l._)("div",M,[(0,l._)("table",N,[q,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.links,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e},[(0,l._)("td",null,(0,i.zw)(e.key),1),(0,l._)("td",null,[(0,l._)("a",{href:e.url,title:e.url},(0,i.zw)(r.shorten(e.url)),9,F)]),(0,l._)("td",null,[(0,l._)("a",{href:e.url},"https://shawnl.ink/"+(0,i.zw)(e.key),9,T)]),(0,l._)("td",null,[(0,l._)("div",W,[(0,l.Wm)(o,{to:{name:"EditLink",params:{editKey:e.key}},type:"button",class:"btn btn-sm btn-info"},{default:(0,l.w5)((()=>[Z])),_:2},1032,["to"]),(0,l._)("button",{type:"button",class:"btn btn-sm btn-info",onClick:t=>r.deleteLink(e)}," Delete ",8,R),(0,l._)("button",{type:"button",class:"btn btn-sm btn-info",onClick:t=>r.copyToClipboard(e)}," Copy ",8,$)])])])))),128))])])])])])}var V={name:"Home",setup(){async function e(e){if(navigator.clipboard)try{await navigator.clipboard.writeText(`https://shawnl.ink/${e.key}`)}catch{H.setError("Failed to copy to clipboard: Exception thrown")}else H.setError("Failed to copy to clipboard: Not supported")}async function t(e){H.setBusy("Deleting Links..."),H.clearError();try{const t=await C()["delete"](`/api/links/${e.key}`);if(200===t.status){const t=H.links.value.indexOf(e);t>-1&&H.links.value.splice(t,1)}}catch{H.setError(`Could not delete ${e.key}`)}finally{H.clearBusy()}}function n(e){const t=e.split("/",3).join("/").length;return e.substring(0,t)+"/..."}return(0,l.bv)((()=>H.loadLinks())),{links:H.links,copyToClipboard:e,deleteLink:t,shorten:n}}};const Y=(0,O.Z)(V,[["render",P]]);var A=Y;const G={class:"col-6 offset-3"},I={class:"form-group"},J=(0,l._)("label",{for:"key"},"Key",-1),Q=["disabled"],X={class:"form-group"},ee=(0,l._)("label",{for:"url"},"Url",-1),te=(0,l._)("div",{class:"form-group"},[(0,l._)("input",{type:"submit",class:"btn btn-success",value:"Save"})],-1);function ne(e,t,n,a,s,o){return(0,l.wg)(),(0,l.iD)("div",G,[(0,l._)("h3",null,(0,i.zw)(a.title),1),(0,l._)("form",{novalidate:"",onSubmit:t[2]||(t[2]=(0,r.iM)((e=>a.onSave()),["prevent"]))},[(0,l._)("div",I,[J,(0,l.wy)((0,l._)("input",{type:"text",id:"key",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=e=>a.link.key=e),placeholder:"Unique Key",disabled:!a.isNew},null,8,Q),[[r.nr,a.link.key]])]),(0,l._)("div",X,[ee,(0,l.wy)((0,l._)("input",{type:"text",id:"url",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>a.link.url=e),placeholder:"https://..."},null,512),[[r.nr,a.link.url]])]),te],32)])}var re={props:{editKey:{required:!1}},setup(e){const t=(0,E.iH)({key:(0,E.iH)(""),url:(0,E.iH)("")}),n=(0,E.iH)("New Shawn Link"),r=(0,E.iH)(!0);async function i(){H.setBusy("Saving Link..."),H.clearError();try{if(r.value){const e=await C().post("/api/links",t.value);H.links.value.push(e.data),me.push("/")}else{const e=await C().put("/api/links",t.value),n=H.links.value.find((t=>t.key===e.data.key));n>0&&H.links.value.splice(n,1,H.data),me.push("/")}}catch{H.setError("Could not save")}finally{H.clearBusy()}}return(0,l.bv)((()=>{if(e.editKey){const l=H.links.value.find((t=>t.key===e.editKey));l&&(r.value=!1,n.value="Editing Shawn Link",t.value.key=l.key,t.value.url=l.url)}})),{onSave:i,link:t,title:n,isNew:r}}};const le=(0,O.Z)(re,[["render",ne]]);var ie=le;const ae={class:"row"},se={class:"col-12"},oe=(0,l._)("h2",null,"Usage Report",-1),ue={class:"table-responsive"},ce={class:"table table-sm table-bordered"},de=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"Short Code"),(0,l._)("th",null,"Count")])],-1);function ve(e,t,n,r,a,s){return(0,l.wg)(),(0,l.iD)("div",ae,[(0,l._)("div",se,[oe,(0,l._)("div",ue,[(0,l._)("table",ce,[de,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.summaries,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.key},[(0,l._)("td",null,(0,i.zw)(e.key),1),(0,l._)("td",null,(0,i.zw)(e.clickCount),1)])))),128))])])])])])}var pe=(0,l.aZ)({name:"SummaryReport",setup(){const e=(0,E.qj)([]);return(0,l.bv)((async()=>{const t=await H.loadSummaries();e.splice(0,e.length,...t)})),{summaries:e}}});const ye=(0,O.Z)(pe,[["render",ve]]);var fe=ye;const ke=(e,t,n)=>{H.isLoaded.value?n():n("/")},he=[{path:"/",name:"Home",component:A},{path:"/editor/:editKey",name:"EditLink",component:ie,props:!0,beforeEnter:ke},{path:"/editor",name:"NewLink",component:ie,beforeEnter:ke},{path:"/summaries",name:"Summaries",component:fe}],be=(0,K.p7)({history:(0,K.r5)(),routes:he});var me=be;(0,r.ri)(x).use(me).mount("#admin")}},t={};function n(r){var l=t[r];if(void 0!==l)return l.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,r,l,i){if(!r){var a=1/0;for(c=0;c<e.length;c++){r=e[c][0],l=e[c][1],i=e[c][2];for(var s=!0,o=0;o<r.length;o++)(!1&i||a>=i)&&Object.keys(n.O).every((function(e){return n.O[e](r[o])}))?r.splice(o--,1):(s=!1,i<a&&(a=i));if(s){e.splice(c--,1);var u=l();void 0!==u&&(t=u)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[r,l,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={328:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var l,i,a=r[0],s=r[1],o=r[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(l in s)n.o(s,l)&&(n.m[l]=s[l]);if(o)var c=o(n)}for(t&&t(r);u<a.length;u++)i=a[u],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(c)},r=self["webpackChunkclient"]=self["webpackChunkclient"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(3038)}));r=n.O(r)})();
//# sourceMappingURL=admin.js.map