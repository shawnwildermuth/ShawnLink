(function(){"use strict";var e={3887:function(e,t,n){var r=n(9242),l=n(3396),i=n(7139);const a={class:"bg-white text-dark"},s={class:"navbar navbar-dark bg-dark"},o={class:"nav nav-pill"},u={class:"nav-item"},c=(0,l.Uk)("List"),d={class:"nav-item"},v=(0,l.Uk)("New"),p={class:"nav-item"},y=(0,l.Uk)("Reports"),f=(0,l._)("li",{class:"nav-item"},[(0,l._)("a",{href:"/signout-oidc"},"Logout")],-1),k={class:"row"},h={class:"col-12"},b={key:0,class:"alert alert-danger"},m={key:1,class:"alert alert-info"},_=(0,l._)("i",{class:"fas fa-spin fa-spinner"},null,-1),w={class:"row"},g={class:"col-12"};function L(e,t,n,r,L,E){const C=(0,l.up)("router-link"),B=(0,l.up)("router-view");return(0,l.wg)(),(0,l.iD)("div",a,[(0,l._)("nav",s,[(0,l._)("ul",o,[(0,l._)("li",u,[(0,l.Wm)(C,{to:"/",class:"nav-link"},{default:(0,l.w5)((()=>[c])),_:1})]),(0,l._)("li",d,[(0,l.Wm)(C,{to:"/editor",class:"nav-link"},{default:(0,l.w5)((()=>[v])),_:1})]),(0,l._)("li",p,[(0,l.Wm)(C,{to:"/summaries",class:"nav-link"},{default:(0,l.w5)((()=>[y])),_:1})]),f])]),(0,l._)("div",k,[(0,l._)("div",h,[e.error?((0,l.wg)(),(0,l.iD)("div",b,(0,i.zw)(e.error),1)):(0,l.kq)("",!0),e.isBusy?((0,l.wg)(),(0,l.iD)("div",m,[_,(0,l.Uk)(" "+(0,i.zw)(e.busyMessage),1)])):(0,l.kq)("",!0),(0,l._)("div",w,[(0,l._)("div",g,[(0,l.Wm)(B)])])])])])}var E=n(4870),C=n(6265),B=n.n(C);const H={isBusy:(0,E.iH)(!1),busyMessage:(0,E.iH)(""),error:(0,E.iH)(""),links:(0,E.iH)([]),isLoaded:(0,E.iH)(!1),async loadLinks(){this.setBusy("Loading Links..."),this.clearError();try{var e=await B().get("/api/links");this.links.value=e.data.sort(((e,t)=>e.key.localeCompare(t.key))),this.isLoaded.value=!0}catch(t){console.error(t),this.setError("Failed to load links")}finally{this.clearBusy()}},async loadSummaries(){this.setBusy("Loading Report"),this.clearError();try{var e=await B().get("/api/links/summary");return e.data}catch(t){console.error(t),this.setError("Failed to load report")}finally{this.clearBusy()}},setError(e){this.error.value=e},clearError(){this.error.value=""},setBusy(e){this.isBusy.value=!0,e&&(this.busyMessage.value=e)},clearBusy(){this.isBusy.value=!1,this.busyMessage.value=""}};var D=H,O={setup(){return{...D}}},S=n(89);const x=(0,S.Z)(O,[["render",L]]);var K=x,U=n(678);const j={class:"row"},z={class:"col-12"},M=(0,l._)("h2",null,"Links Management",-1),N={class:"table-responsive"},q={class:"table table-sm table-bordered"},F=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"Key"),(0,l._)("th",null,"Destination"),(0,l._)("th",null,"Link"),(0,l._)("th")])],-1),T=["href","title"],W=["href"],Z={class:"btn-group",role:"group"},R=(0,l.Uk)("Edit"),$=["onClick"],P=["onClick"];function V(e,t,n,r,a,s){const o=(0,l.up)("router-link");return(0,l.wg)(),(0,l.iD)("div",j,[(0,l._)("div",z,[M,(0,l._)("div",N,[(0,l._)("table",q,[F,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.links,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e},[(0,l._)("td",null,(0,i.zw)(e.key),1),(0,l._)("td",null,[(0,l._)("a",{href:e.url,title:e.url},(0,i.zw)(r.shorten(e.url)),9,T)]),(0,l._)("td",null,[(0,l._)("a",{href:e.url},"https://shawnl.ink/"+(0,i.zw)(e.key),9,W)]),(0,l._)("td",null,[(0,l._)("div",Z,[(0,l.Wm)(o,{to:{name:"EditLink",params:{editKey:e.key}},type:"button",class:"btn btn-sm btn-info"},{default:(0,l.w5)((()=>[R])),_:2},1032,["to"]),(0,l._)("button",{type:"button",class:"btn btn-sm btn-info",onClick:t=>r.deleteLink(e)}," Delete ",8,$),(0,l._)("button",{type:"button",class:"btn btn-sm btn-info",onClick:t=>r.copyToClipboard(e)}," Copy ",8,P)])])])))),128))])])])])])}var Y={name:"Home",setup(){async function e(e){if(navigator.clipboard)try{await navigator.clipboard.writeText(`https://shawnl.ink/${e.key}`)}catch{D.setError("Failed to copy to clipboard: Exception thrown")}else D.setError("Failed to copy to clipboard: Not supported")}async function t(e){D.setBusy("Deleting Links..."),D.clearError();try{const t=await B()["delete"](`/api/links/${e.key}`);if(200===t.status){const t=D.links.value.indexOf(e);t>-1&&D.links.value.splice(t,1)}}catch{D.setError(`Could not delete ${e.key}`)}finally{D.clearBusy()}}function n(e){const t=e.split("/",3).join("/").length;return e.substring(0,t)+"/..."}return(0,l.bv)((()=>D.loadLinks())),{links:D.links,copyToClipboard:e,deleteLink:t,shorten:n}}};const A=(0,S.Z)(Y,[["render",V]]);var G=A;const I={class:"col-6 offset-3"},J={class:"form-group"},Q=(0,l._)("label",{for:"key"},"Key",-1),X=["disabled"],ee={class:"form-group"},te=(0,l._)("label",{for:"url"},"Url",-1),ne=(0,l._)("div",{class:"form-group"},[(0,l._)("input",{type:"submit",class:"btn btn-success",value:"Save"})],-1);function re(e,t,n,a,s,o){return(0,l.wg)(),(0,l.iD)("div",I,[(0,l._)("h3",null,(0,i.zw)(a.title),1),(0,l._)("form",{novalidate:"",onSubmit:t[2]||(t[2]=(0,r.iM)((e=>a.onSave()),["prevent"]))},[(0,l._)("div",J,[Q,(0,l.wy)((0,l._)("input",{type:"text",id:"key",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=e=>a.link.key=e),placeholder:"Unique Key",disabled:!a.isNew},null,8,X),[[r.nr,a.link.key]])]),(0,l._)("div",ee,[te,(0,l.wy)((0,l._)("input",{type:"text",id:"url",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>a.link.url=e),placeholder:"https://..."},null,512),[[r.nr,a.link.url]])]),ne],32)])}var le={props:{editKey:{required:!1}},setup(e){const t=(0,E.iH)({key:(0,E.iH)(""),url:(0,E.iH)("")}),n=(0,E.iH)("New Shawn Link"),r=(0,E.iH)(!0);async function i(){D.setBusy("Saving Link..."),D.clearError();try{if(r.value){const e=await B().post("/api/links",t.value);D.links.value.push(e.data),_e.push("/")}else{const e=await B().put("/api/links",t.value),n=D.links.value.find((t=>t.key===e.data.key));n>0&&D.links.value.splice(n,1,D.data),_e.push("/")}}catch{D.setError("Could not save")}finally{D.clearBusy()}}return(0,l.bv)((()=>{if(e.editKey){const l=D.links.value.find((t=>t.key===e.editKey));l&&(r.value=!1,n.value="Editing Shawn Link",t.value.key=l.key,t.value.url=l.url)}})),{onSave:i,link:t,title:n,isNew:r}}};const ie=(0,S.Z)(le,[["render",re]]);var ae=ie;const se={class:"row"},oe={class:"col-12"},ue=(0,l._)("h2",null,"Usage Report",-1),ce={class:"table-responsive"},de={class:"table table-sm table-bordered"},ve=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"Short Code"),(0,l._)("th",null,"Count")])],-1);function pe(e,t,n,r,a,s){return(0,l.wg)(),(0,l.iD)("div",se,[(0,l._)("div",oe,[ue,(0,l._)("div",ce,[(0,l._)("table",de,[ve,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.summaries,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.key},[(0,l._)("td",null,(0,i.zw)(e.key),1),(0,l._)("td",null,(0,i.zw)(e.clickCount),1)])))),128))])])])])])}var ye=(0,l.aZ)({name:"SummaryReport",setup(){const e=(0,E.qj)([]);return(0,l.bv)((async()=>{const t=await D.loadSummaries();e.splice(0,e.length,...t)})),{summaries:e}}});const fe=(0,S.Z)(ye,[["render",pe]]);var ke=fe;const he=(e,t,n)=>{D.isLoaded.value?n():n("/")},be=[{path:"/",name:"Home",component:G},{path:"/editor/:editKey",name:"EditLink",component:ae,props:!0,beforeEnter:he},{path:"/editor",name:"NewLink",component:ae,beforeEnter:he},{path:"/summaries",name:"Summaries",component:ke}],me=(0,U.p7)({history:(0,U.r5)(),routes:be});var _e=me;(0,r.ri)(K).use(_e).mount("#admin")}},t={};function n(r){var l=t[r];if(void 0!==l)return l.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,r,l,i){if(!r){var a=1/0;for(c=0;c<e.length;c++){r=e[c][0],l=e[c][1],i=e[c][2];for(var s=!0,o=0;o<r.length;o++)(!1&i||a>=i)&&Object.keys(n.O).every((function(e){return n.O[e](r[o])}))?r.splice(o--,1):(s=!1,i<a&&(a=i));if(s){e.splice(c--,1);var u=l();void 0!==u&&(t=u)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[r,l,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={328:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var l,i,a=r[0],s=r[1],o=r[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(l in s)n.o(s,l)&&(n.m[l]=s[l]);if(o)var c=o(n)}for(t&&t(r);u<a.length;u++)i=a[u],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(c)},r=self["webpackChunkclient"]=self["webpackChunkclient"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(3887)}));r=n.O(r)})();
//# sourceMappingURL=admin.js.map